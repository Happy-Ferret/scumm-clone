$(document).ready(function(){function a(){j=d(),l+=Math.min(1,(j-m)/1e3),b(l),m=j,requestAnimationFrame(a)}function b(){for(var a=0;a<n.length;a++)n[a].move()}function c(a,b,c,d){var e=Math.min(c/a,d/b);return{width:a*e,height:b*e}}function d(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function e(){this.items={},this.init=function(){return this.canvas=$("<canvas></canvas>").attr({id:"inv",width:p,height:r}).css({"z-index":9e6,top:q-r}),this.ctx=this.canvas[0].getContext("2d"),this.ctx.fillStyle="rgba(0, 0, 0, 1)",this.ctx.fillRect(0,0,p,r),$("#container").append(this.canvas),this},this.init()}function f(a,b,d){if(this.canvas=$("<canvas></canvas>").attr({id:a,width:p,height:q-r}).css("z-index",d),this.ctx=this.canvas[0].getContext("2d"),0!==b){var e=new Image;e.src=b;var f=this;e.onload=function(){var a=c(this.width,this.height,1e9,s);f.ctx.drawImage(e,0,0,this.width,this.height,0,0,a.width,a.height)}}return this}function g(a){this.dest={},this.x,this.y,this.w=150,this.h=150,this.inventory=new e,this.scene=a,this.init=function(){this.sprite=new i(a),this.ctx=a.spriteLayers[0].ctx,n.push(this),this.spawn(600,300)},this.spawn=function(a,b){this.x=a,this.y=b,this.ctx.fillRect(this.x,this.y,this.w,this.h)},this.move=function(){this.sprite.clear()},this.init()}function h(a){this.bgLayers=new Array,this.spriteLayers=new Array,this.init=function(){this.getLayers()},this.getLayers=function(){var b=a.imageLayers,c=0;for(var d in b){var e=b[d];for(var g in e)if(e.hasOwnProperty(g)){var h=new f("background"+c,e[g],c);this.bgLayers.push(h),c++}}},this.show=function(){for(var a=0;a<this.bgLayers.length;a++)$("#container").append(this.bgLayers[a].canvas);var b=new f("spritelayer0",0,9999);this.spriteLayers.push(b),$("#container").append(b.canvas);var b=new f("controlLayer",0,9999);$("#container").append(b.canvas),k=this,this.setupControls()},this.setupControls=function(){$("#controlLayer").on("click",function(a){console.log(a)})},this.init()}function i(a){this.init=function(){this.ctx=a.spriteLayers[0].ctx,this.ctx.fillStyle="rgb(244,244,244)"},this.clear=function(){this.ctx.clearRect(this.x,this.y,this.w,this.h)},this.init()}var j,k,l=0,m=d(),n=new Array;requestAnimationFrame(a);var o={imageLayers:{0:{image:"assets/scenes/mi1street/street.png"}},persPoint:{x:160,y:70}},p=1024,q=768,r=250,s=q-r,t=new h(o);t.show();new g(t)});